<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>プレミアム高級時計</title>
    <style>
        /* ===== ベーススタイル ===== */
        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            background: 
                radial-gradient(ellipse at top, #2c1810, #1a1a1a),
                linear-gradient(135deg, #0f0f0f, #2d2d2d);
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Georgia', serif;
            overflow: hidden;
        }

        /* ===== メインシーン構成 ===== */
        .scene {
            position: relative;
            width: 450px;
            height: 450px;
            perspective: 1200px;
        }

        /* ===== 時計ケース ===== */
        .watch-case {
            position: relative;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: 
                radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.7), rgba(245, 245, 245, 0.6), rgba(232, 232, 232, 0.7)),
                linear-gradient(135deg, rgba(248, 248, 248, 0.6), rgba(224, 224, 224, 0.6));
            box-shadow: 
                0 0 80px rgba(255, 255, 255, 0.4),
                inset 0 0 50px rgba(0, 0, 0, 0.08),
                0 25px 60px rgba(0, 0, 0, 0.6),
                0 5px 20px rgba(0, 0, 0, 0.3);
            transform-style: preserve-3d;
            transition: transform 0.3s ease;
        }

        /* ===== ダイヤモンドベゼル ===== */
        .diamond-bezel {
            position: absolute;
            top: -15px;
            left: -15px;
            width: 480px;
            height: 480px;
            border-radius: 50%;
            background: 
                linear-gradient(45deg, #ffd700, #ffed4e, #ffd700, #e6c200),
                radial-gradient(circle at 30% 30%, #fff, transparent 60%);
            z-index: -1;
            animation: gentle-glow 4s ease-in-out infinite alternate;
        }

        /* ===== アニメーション定義 ===== */
        @keyframes gentle-glow {
            0% { box-shadow: 0 0 40px rgba(255, 215, 0, 0.3); }
            100% { box-shadow: 0 0 60px rgba(255, 215, 0, 0.5); }
        }

        @keyframes diamond-rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes sunray-rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes diamond-shine {
            0% { 
                box-shadow: 
                    0 0 25px rgba(255, 255, 255, 0.9),
                    inset 0 0 8px rgba(0, 0, 0, 0.15),
                    0 0 15px rgba(255, 215, 0, 0.4);
            }
            100% { 
                box-shadow: 
                    0 0 35px rgba(255, 255, 255, 1),
                    inset 0 0 12px rgba(0, 0, 0, 0.1),
                    0 0 25px rgba(255, 215, 0, 0.6);
            }
        }

        @keyframes sparkle-point {
            0%, 100% { opacity: 0.8; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        @keyframes second-pulse {
            0%, 100% { opacity: 1; box-shadow: 0 0 8px rgba(255, 51, 51, 0.4); }
            50% { opacity: 0.9; box-shadow: 0 0 12px rgba(255, 51, 51, 0.6); }
        }

        @keyframes reflection-shift {
            0% { opacity: 0.6; transform: rotate(-20deg) scale(1); }
            100% { opacity: 0.4; transform: rotate(-15deg) scale(1.1); }
        }

        /* ===== ベゼル装飾効果 ===== */
        .diamond-bezel::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 15px;
            width: 450px;
            height: 450px;
            border-radius: 50%;
            background: repeating-conic-gradient(
                from 0deg,
                transparent 0deg,
                rgba(255, 255, 255, 0.9) 1.5deg,
                transparent 3deg,
                rgba(255, 255, 255, 0.7) 4.5deg,
                transparent 6deg
            );
            animation: diamond-rotation 8s linear infinite;
        }

        /* ===== 文字盤 ===== */
        .watch-face {
            position: absolute;
            top: 30px;
            left: 30px;
            width: 390px;
            height: 390px;
            border-radius: 50%;
            background: 
                radial-gradient(circle at 35% 35%, rgba(255, 255, 255, 0.3), rgba(248, 248, 248, 0.2) 40%, rgba(232, 232, 232, 0.4)),
                conic-gradient(from 90deg, rgba(240, 240, 240, 0.6), rgba(232, 232, 232, 0.6), rgba(240, 240, 240, 0.6), rgba(232, 232, 232, 0.6), rgba(240, 240, 240, 0.6));
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 30px rgba(0, 0, 0, 0.1);
        }

        /* ===== サンレイ効果 ===== */
        .sunray-effect {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-conic-gradient(
                from 0deg at 50% 50%,
                transparent 0deg,
                rgba(255, 255, 255, 0.4) 0.5deg,
                transparent 1deg,
                rgba(255, 255, 255, 0.2) 1.5deg,
                transparent 2deg
            );
            animation: sunray-rotation 30s linear infinite;
            opacity: 0.8;
            z-index: 1;
        }

        /* ===== 時間インデックス ===== */
        .hour-index {
            position: absolute;
            width: 6px;
            height: 35px;
            background: 
                linear-gradient(to bottom, #ffd700, #ffed4e, #e6c200),
                radial-gradient(ellipse at center, #fff, transparent 70%);
            border-radius: 3px;
            transform-origin: center bottom;
            box-shadow: 
                0 0 12px rgba(255, 215, 0, 0.6),
                inset 0 0 3px rgba(255, 255, 255, 0.8);
        }

        /* ===== プレミアムダイヤモンド ===== */
        .premium-diamond {
            position: absolute;
            width: 16px;
            height: 16px;
            background: 
                radial-gradient(circle at 30% 30%, #ffffff, #f8f8f8, #e8e8e8),
                linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.8) 50%, transparent 70%);
            border-radius: 50%;
            border: 3px solid #ffd700;
            transform-origin: center;
            box-shadow: 
                0 0 25px rgba(255, 255, 255, 0.9),
                inset 0 0 8px rgba(0, 0, 0, 0.15),
                0 0 15px rgba(255, 215, 0, 0.4);
            animation: diamond-shine 3s ease-in-out infinite alternate;
        }

        .premium-diamond::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 6px;
            height: 6px;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.9), transparent);
            border-radius: 50%;
            animation: sparkle-point 2s ease-in-out infinite;
        }

        /* ===== 中心ハブ ===== */
        .center-hub {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            background: 
                radial-gradient(circle at 30% 30%, #ffd700, #e6c200, #b8860b),
                linear-gradient(45deg, #ffed4e, #ffd700);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 14;
            box-shadow: 
                0 0 15px rgba(255, 215, 0, 0.7),
                inset 0 0 5px rgba(255, 255, 255, 0.6);
        }

        /* ===== 時計の針 ===== */
        .watch-hand {
            position: absolute;
            top: 50%;
            left: 50%;
            transform-origin: center bottom;
            border-radius: 2px;
            background: 
                linear-gradient(to top, #ffd700, #ffed4e, #fff),
                radial-gradient(ellipse at center, rgba(255, 255, 255, 0.8), transparent 70%);
            box-shadow: 
                0 0 12px rgba(255, 215, 0, 0.5),
                inset 0 0 3px rgba(255, 255, 255, 0.8);
        }

        /* 時針 */
        .hour-hand {
            width: 10px;
            height: 100px;
            margin-left: -4px;
            margin-top: -100px;
            z-index: 10;
            background: 
                linear-gradient(to top, #e6c200, #ffd700, #ffed4e, #fff),
                radial-gradient(ellipse at center, rgba(255, 255, 255, 0.9), transparent 60%);
        }

        /* 分針 */
        .minute-hand {
            width: 6px;
            height: 140px;
            margin-left: -3px;
            margin-top: -140px;
            z-index: 11;
            background: 
                linear-gradient(to top, #e6c200, #ffd700, #ffed4e, #fff),
                radial-gradient(ellipse at center, rgba(255, 255, 255, 0.9), transparent 60%);
        }

        /* 秒針 */
        .second-hand {
            width: 3px;
            height: 150px;
            margin-left: -1.5px;
            margin-top: -150px;
            background: 
                linear-gradient(to top, #cc0000, #ff3333, #ff6666),
                radial-gradient(ellipse at center, rgba(255, 255, 255, 0.7), transparent 50%);
            z-index: 13;
            animation: second-pulse 1s ease-in-out infinite;
        }

        /* ===== 日付表示 ===== */
        .date-display {
            position: absolute;
            top: 50%;
            right: 20%;
            width: 40px;
            height: 28px;
            background: 
                linear-gradient(135deg, #ffffff, #f8f8f8),
                radial-gradient(ellipse at top, rgba(255, 255, 255, 0.9), transparent);
            border: 3px solid #ffd700;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: bold;
            color: #333;
            box-shadow: 
                inset 0 0 8px rgba(0, 0, 0, 0.15),
                0 0 10px rgba(255, 215, 0, 0.3);
            transform: translateY(-50%);
            font-family: 'Arial', sans-serif;
        }

        /* ===== ブランド表示 ===== */
        .luxury-brand {
            position: absolute;
            top: 25%;
            left: 50%;
            transform: translateX(-50%);
            font-size: 14px;
            font-weight: bold;
            color: #666;
            text-align: center;
            letter-spacing: 3px;
            font-family: 'Georgia', serif;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.8);
        }

        /* ===== 歴史表示 ===== */
        .history-display {
            position: absolute;
            top: 65%;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            font-family: 'Hiragino Kaku Gothic Pro', 'Yu Gothic', 'Meiryo', sans-serif;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            z-index: 5;
            cursor: pointer;
        }
        
        .history-display.visible {
            opacity: 1;
        }
        
        .era-text {
            font-size: 14px;
            color: #666;
            letter-spacing: 1px;
            margin-bottom: 2px;
        }
        
        .event-text {
            font-size: 18px;
            color: #888;
            letter-spacing: 0.5px;
        }
        
        /* ===== 詳細情報表示 ===== */
        .history-detail {
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(20, 20, 20, 0.95));
            border: 3px solid #ffd700;
            border-radius: 15px;
            padding: 20px 25px;
            text-align: center;
            font-family: 'Hiragino Kaku Gothic Pro', 'Yu Gothic', 'Meiryo', sans-serif;
            color: #ffd700;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s ease-in-out;
            z-index: 9999;
            min-width: 250px;
            max-width: 400px;
            box-shadow: 
                0 0 50px rgba(255, 215, 0, 0.7),
                0 10px 30px rgba(0, 0, 0, 0.8),
                inset 0 0 20px rgba(0, 0, 0, 0.3);
            pointer-events: none;
            backdrop-filter: blur(10px);
        }
        
        .history-detail.visible {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }
        
        .detail-year {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #fff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
        }
        
        .detail-era {
            font-size: 18px;
            margin-bottom: 10px;
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
        }
        
        .detail-description {
            font-size: 16px;
            line-height: 1.5;
            color: #ddd;
            text-shadow: 0 0 5px rgba(221, 221, 221, 0.5);
        }

        /* ===== デジタル表示 ===== */
        .digital-display {
            position: absolute;
            bottom: -80px;
            left: 50%;
            transform: translateX(-50%);
            color: #ffd700;
            font-size: 22px;
            font-weight: bold;
            text-shadow: 
                0 0 15px rgba(255, 215, 0, 0.8),
                0 0 30px rgba(255, 215, 0, 0.4);
            font-family: 'Courier New', monospace;
            background: rgba(0, 0, 0, 0.8);
            padding: 8px 16px;
            border-radius: 8px;
            border: 2px solid rgba(255, 215, 0, 0.3);
        }

        /* ===== 反射効果 ===== */
        .reflection {
            position: absolute;
            top: 50px;
            left: 80px;
            width: 120px;
            height: 180px;
            background: 
                linear-gradient(135deg, 
                    rgba(255, 255, 255, 0.4) 0%,
                    rgba(255, 255, 255, 0.2) 30%,
                    transparent 60%
                );
            border-radius: 50%;
            transform: rotate(-20deg);
            pointer-events: none;
            animation: reflection-shift 6s ease-in-out infinite alternate;
        }

        /* ===== スマホ対応レスポンシブ ===== */
        @media (max-width: 768px) {
            .scene {
                width: 300px;
                height: 300px;
            }
            
            .diamond-bezel {
                top: -10px;
                left: -10px;
                width: 320px;
                height: 320px;
            }
            
            .diamond-bezel::before {
                top: 10px;
                left: 10px;
                width: 300px;
                height: 300px;
            }
            
            .watch-face {
                top: 20px;
                left: 20px;
                width: 260px;
                height: 260px;
            }
            
            .hour-index {
                width: 4px;
                height: 23px;
            }
            
            .hour-index[style*="transform-origin: center 175px"] {
                transform-origin: center 117px !important;
            }
            
            .premium-diamond {
                width: 11px;
                height: 11px;
                border-width: 2px;
            }
            
            .premium-diamond::before {
                top: 1px;
                left: 1px;
                width: 4px;
                height: 4px;
            }
            
            .center-hub {
                width: 13px;
                height: 13px;
            }
            
            .hour-hand {
                width: 7px;
                height: 67px;
                margin-left: -3px;
                margin-top: -67px;
            }
            
            .minute-hand {
                width: 4px;
                height: 93px;
                margin-left: -2px;
                margin-top: -93px;
            }
            
            .second-hand {
                width: 2px;
                height: 100px;
                margin-left: -1px;
                margin-top: -100px;
            }
            
            .date-display {
                width: 27px;
                height: 19px;
                font-size: 11px;
                border-width: 2px;
                border-radius: 4px;
            }
            
            .luxury-brand {
                font-size: 9px;
                letter-spacing: 2px;
            }
            
            .era-text {
                font-size: 6px;
                letter-spacing: 0.5px;
            }
            
            .event-text {
                font-size: 5px;
                letter-spacing: 0.3px;
            }
            
            .history-detail {
                top: -80px;
                padding: 10px 15px;
                min-width: 150px;
            }
            
            .detail-year {
                font-size: 12px;
                margin-bottom: 5px;
            }
            
            .detail-era {
                font-size: 10px;
                margin-bottom: 5px;
            }
            
            .detail-description {
                font-size: 8px;
                line-height: 1.3;
            }
            
            .digital-display {
                bottom: -53px;
                font-size: 15px;
                padding: 5px 11px;
                border-radius: 5px;
            }
            
            .reflection {
                top: 33px;
                left: 53px;
                width: 80px;
                height: 120px;
            }
        }
    </style>
<!-- 基本ファビコン -->
<link rel="icon" type="image/png" sizes="16x16" href="/luxury_watch/assets/favicons/favicon-lion-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/luxury_watch/assets/favicons/favicon-lion-32x32.png">
<link rel="icon" type="image/png" sizes="48x48" href="/luxury_watch/assets/favicons/favicon-lion-48x48.png">
<link rel="icon" type="image/png" sizes="64x64" href="/luxury_watch/assets/favicons/favicon-lion-64x64.png">

<!-- Apple Touch Icon -->
<link rel="apple-touch-icon" sizes="57x57" href="/luxury_watch/assets/favicons/apple-touch-icon-lion-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/luxury_watch/assets/favicons/apple-touch-icon-lion-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/luxury_watch/assets/favicons/apple-touch-icon-lion-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/luxury_watch/assets/favicons/apple-touch-icon-lion-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/luxury_watch/assets/favicons/apple-touch-icon-lion-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/luxury_watch/assets/favicons/apple-touch-icon-lion-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/luxury_watch/assets/favicons/apple-touch-icon-lion-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/luxury_watch/assets/favicons/apple-touch-icon-lion-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/luxury_watch/assets/favicons/apple-touch-icon-lion-180x180.png">

<!-- Android Chrome -->
<link rel="icon" type="image/png" sizes="192x192" href="/luxury_watch/assets/favicons/android-chrome-lion-192x192.png">
<link rel="icon" type="image/png" sizes="512x512" href="/luxury_watch/assets/favicons/android-chrome-lion-512x512.png">

<!-- Microsoft Tiles -->
<meta name="msapplication-square70x70logo" content="/luxury_watch/assets/favicons/mstile-lion-70x70.png">
<meta name="msapplication-square144x144logo" content="/luxury_watch/assets/favicons/mstile-lion-144x144.png">
<meta name="msapplication-square150x150logo" content="/luxury_watch/assets/favicons/mstile-lion-150x150.png">
<meta name="msapplication-wide310x150logo" content="/luxury_watch/assets/favicons/mstile-lion-310x150.png">
<meta name="msapplication-square310x310logo" content="/luxury_watch/assets/favicons/mstile-lion-310x310.png">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <div class="scene">
        <!-- ダイヤモンドベゼル -->
        <div class="diamond-bezel"></div>
        
        <!-- メイン時計ケース -->
        <div class="watch-case" id="watchCase">
            <div class="watch-face">
                <!-- サンレイ効果 -->
                <div class="sunray-effect"></div>
                
                <!-- 光の反射 -->
                <div class="reflection"></div>
                
                <!-- ブランド表示 -->
                <div class="luxury-brand">GOLDEN LION</div>
                <div class="history-display" id="historyDisplay">
                    <div class="era-text" id="eraText"></div>
                    <div class="event-text" id="eventText"></div>
                </div>
                
                <!-- 詳細情報表示（時計上部） -->
                <div class="history-detail" id="historyDetail">
                    <div class="detail-year" id="detailYear"></div>
                    <div class="detail-era" id="detailEra"></div>
                    <div class="detail-description" id="detailDescription"></div>
                </div>
                
                <!-- プレミアムダイヤモンド（12時、3時、6時、9時位置） -->
                <div class="premium-diamond" style="top: 10px; left: 50%; transform: translateX(-50%);"></div>
                <div class="premium-diamond" style="top: 50%; right: 10px; transform: translateY(-50%);"></div>
                <div class="premium-diamond" style="bottom: 10px; left: 50%; transform: translateX(-50%);"></div>
                <div class="premium-diamond" style="top: 50%; left: 10px; transform: translateY(-50%);"></div>
                
                <!-- ゴールドインデックス（その他の時間位置） -->
                <div class="hour-index" style="top: 20px; left: 50%; transform: translateX(-50%) rotate(30deg); transform-origin: center 175px;"></div>
                <div class="hour-index" style="top: 20px; left: 50%; transform: translateX(-50%) rotate(60deg); transform-origin: center 175px;"></div>
                <div class="hour-index" style="top: 20px; left: 50%; transform: translateX(-50%) rotate(120deg); transform-origin: center 175px;"></div>
                <div class="hour-index" style="top: 20px; left: 50%; transform: translateX(-50%) rotate(150deg); transform-origin: center 175px;"></div>
                <div class="hour-index" style="top: 20px; left: 50%; transform: translateX(-50%) rotate(210deg); transform-origin: center 175px;"></div>
                <div class="hour-index" style="top: 20px; left: 50%; transform: translateX(-50%) rotate(240deg); transform-origin: center 175px;"></div>
                <div class="hour-index" style="top: 20px; left: 50%; transform: translateX(-50%) rotate(300deg); transform-origin: center 175px;"></div>
                <div class="hour-index" style="top: 20px; left: 50%; transform: translateX(-50%) rotate(330deg); transform-origin: center 175px;"></div>
                
                <!-- 日付表示窓 -->
                <div class="date-display" id="dateWindow">01</div>
                
                <!-- 時計の針 -->
                <div class="watch-hand hour-hand" id="hourHand"></div>
                <div class="watch-hand minute-hand" id="minuteHand"></div>
                <div class="watch-hand second-hand" id="secondHand"></div>
                
                <!-- 中心ハブ -->
                <div class="center-hub"></div>
            </div>
        </div>
        
        <!-- デジタル時刻表示 -->
        <div class="digital-display" id="digitalClock">00:00:00</div>
    </div>

    <script>
        // ===== 定数定義 =====
        const CLOCK_UPDATE_INTERVAL = 50; // ms単位（滑らかな秒針のため）
        const HOUR_ANGLE_PER_HOUR = 30;   // 1時間あたりの角度
        const MINUTE_ANGLE_PER_MINUTE = 6; // 1分あたりの角度
        const SECOND_ANGLE_PER_SECOND = 6; // 1秒あたりの角度

        // ===== DOM要素取得 =====
        const hourHand = document.getElementById('hourHand');
        const minuteHand = document.getElementById('minuteHand');
        const secondHand = document.getElementById('secondHand');
        const dateWindow = document.getElementById('dateWindow');
        const digitalClock = document.getElementById('digitalClock');
        const watchCase = document.getElementById('watchCase');
        const historyDisplay = document.getElementById('historyDisplay');
        const eraText = document.getElementById('eraText');
        const eventText = document.getElementById('eventText');
        const historyDetail = document.getElementById('historyDetail');
        const detailYear = document.getElementById('detailYear');
        const detailEra = document.getElementById('detailEra');
        const detailDescription = document.getElementById('detailDescription');

        // ===== 歴史データ読み込み =====
        let historyData = [];
        
        // 歴史データをfetchで読み込み
        async function loadHistoryData() {
            try {
                const response = await fetch('./history.json');
                const data = await response.json();
                historyData = data.events;
                console.log('歴史データを読み込みました:', historyData.length, '件');
            } catch (error) {
                console.error('歴史データの読み込みに失敗しました:', error);
            }
        }
        
        // ===== 時刻から年への変換関数 =====
        function timeToYear(hours, minutes, seconds) {
            // 00:00:00 = 年1, 23:59:59 = 年2025
            const totalSeconds = hours * 3600 + minutes * 60 + seconds;
            const totalSecondsInDay = 24 * 60 * 60; // 86400秒
            const year = Math.floor((totalSeconds / totalSecondsInDay) * 2025) + 1;
            return Math.min(year, 2025);
        }
        
        // ===== 現在の年に対応する歴史イベントを取得 =====
        function getCurrentHistoryEvent(currentYear) {
            // 現在の年に最も近い歴史イベントを検索
            for (let i = historyData.length - 1; i >= 0; i--) {
                if (historyData[i].year <= currentYear) {
                    return historyData[i];
                }
            }
            return historyData[0]; // 見つからない場合は最初のイベント
        }
        
        // ===== 歴史表示の状態管理 =====
        let currentHistoryEvent = null;
        let historyDisplayTimer = null;
        let detailDisplayTimer = null;

        // ===== 歴史表示機能 =====
        function showHistoryEvent(event) {
            if (!event) return;
            
            // 歴史情報を表示
            eraText.textContent = `${event.era} ${event.year}`;
            eventText.textContent = event.event;
            historyDisplay.classList.add('visible');
            
            // 30秒後に自動で非表示
            if (historyDisplayTimer) {
                clearTimeout(historyDisplayTimer);
            }
            historyDisplayTimer = setTimeout(() => {
                historyDisplay.classList.remove('visible');
            }, 10000*3);
        }
        
        function showHistoryDetail(event) {
            if (!event) return;
            
            // 詳細情報を表示
            detailYear.textContent = `${event.year}年`;
            detailEra.textContent = `${event.era}時代`;
            detailDescription.textContent = event.description;
            
            // 現在のカラースキームに合わせてスタイルを更新
            updateHistoryDetailColors();
            
            historyDetail.classList.add('visible');
            
            // 5秒後に自動で非表示
            if (detailDisplayTimer) {
                clearTimeout(detailDisplayTimer);
            }
            detailDisplayTimer = setTimeout(() => {
                historyDetail.classList.remove('visible');
            }, 5000);
        }
        
        // 歴史詳細表示の色をカラースキームに合わせて更新
        function updateHistoryDetailColors() {
            const scheme = colorSchemes[currentColorScheme];
            
            historyDetail.style.background = `
                linear-gradient(135deg, 
                    rgba(0, 0, 0, 0.95), 
                    rgba(20, 20, 20, 0.95)
                )
            `;
            historyDetail.style.borderColor = scheme.border;
            historyDetail.style.boxShadow = `
                0 0 50px ${scheme.glow},
                0 10px 30px rgba(0, 0, 0, 0.8),
                inset 0 0 20px rgba(0, 0, 0, 0.3)
            `;
            
            // テキストの色もカラースキームに合わせる
            detailYear.style.color = '#fff';
            detailYear.style.textShadow = `0 0 15px ${scheme.glow}`;
            detailEra.style.color = scheme.digital;
            detailEra.style.textShadow = `0 0 15px ${scheme.glow}`;
            detailDescription.style.color = '#ddd';
            detailDescription.style.textShadow = `0 0 8px ${scheme.glow.replace('0.6', '0.3')}`;
        }
        
        // ===== 時刻更新機能 =====
        function updateTimepiece() {
            try {
                const currentTime = new Date();
                const hours24 = currentTime.getHours();
                const hours = hours24 % 12;
                const minutes = currentTime.getMinutes();
                const seconds = currentTime.getSeconds();
                const milliseconds = currentTime.getMilliseconds();
                const date = currentTime.getDate();
                
                // 高精度な角度計算（ミリ秒まで考慮した滑らかな動き）
                const preciseSeconds = seconds + (milliseconds / 1000);
                const hourAngle = (hours * HOUR_ANGLE_PER_HOUR) + (minutes * 0.5) + (preciseSeconds * 0.00833);
                const minuteAngle = (minutes * MINUTE_ANGLE_PER_MINUTE) + (preciseSeconds * 0.1);
                const secondAngle = preciseSeconds * SECOND_ANGLE_PER_SECOND;
                
                // 針の回転を適用
                hourHand.style.transform = `rotate(${hourAngle}deg)`;
                minuteHand.style.transform = `rotate(${minuteAngle}deg)`;
                secondHand.style.transform = `rotate(${secondAngle}deg)`;
                
                // 日付表示更新
                dateWindow.textContent = date.toString().padStart(2, '0');
                
                // デジタル時刻表示更新
                const timeString = currentTime.toLocaleTimeString('ja-JP', { 
                    hour12: false,
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                digitalClock.textContent = timeString;
                
                // 歴史表示の更新
                if (historyData.length > 0) {
                    const currentYear = timeToYear(hours24, minutes, seconds);
                    const newHistoryEvent = getCurrentHistoryEvent(currentYear);
                    
                    // 新しい歴史イベントがある場合のみ表示を更新
                    if (!currentHistoryEvent || newHistoryEvent.year !== currentHistoryEvent.year) {
                        currentHistoryEvent = newHistoryEvent;
                        showHistoryEvent(currentHistoryEvent);
                    }
                }
                
            } catch (error) {
                console.error('時刻更新中にエラーが発生しました:', error);
            }
        }
        
        // ===== 3Dインタラクション効果 =====
        let isHovering = false;
        let isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        let deviceOrientationEnabled = false;
        let currentColorScheme = 0; // 0: ゴールド, 1: プラチナ, 2: ローズゴールド, 3: ブラック
        
        // ===== カラースキーム定義 =====
        const colorSchemes = [
            {
                name: 'ゴールド',
                bezel: 'linear-gradient(45deg, #ffd700, #ffed4e, #ffd700, #e6c200)',
                border: '#ffd700',
                indices: 'linear-gradient(to bottom, #ffd700, #ffed4e, #e6c200)',
                hands: 'linear-gradient(to top, #ffd700, #ffed4e, #fff)',
                hourHands: 'linear-gradient(to top, #e6c200, #ffd700, #ffed4e, #fff)',
                minuteHands: 'linear-gradient(to top, #e6c200, #ffd700, #ffed4e, #fff)',
                centerHub: 'radial-gradient(circle at 30% 30%, #ffd700, #e6c200, #b8860b), linear-gradient(45deg, #ffed4e, #ffd700)',
                glow: 'rgba(255, 215, 0, 0.6)',
                digital: '#ffd700'
            },
            {
                name: 'プラチナ',
                bezel: 'linear-gradient(45deg, #e5e5e5, #f8f8f8, #e5e5e5, #d0d0d0)',
                border: '#e5e5e5',
                indices: 'linear-gradient(to bottom, #e5e5e5, #f8f8f8, #d0d0d0)',
                hands: 'linear-gradient(to top, #e5e5e5, #f8f8f8, #fff)',
                hourHands: 'linear-gradient(to top, #d0d0d0, #e5e5e5, #f8f8f8, #fff)',
                minuteHands: 'linear-gradient(to top, #d0d0d0, #e5e5e5, #f8f8f8, #fff)',
                centerHub: 'radial-gradient(circle at 30% 30%, #e5e5e5, #d0d0d0, #b8b8b8), linear-gradient(45deg, #f8f8f8, #e5e5e5)',
                glow: 'rgba(229, 229, 229, 0.6)',
                digital: '#e5e5e5'
            },
            {
                name: 'ローズゴールド',
                bezel: 'linear-gradient(45deg, #e8b4b8, #f4d2d7, #e8b4b8, #d49499)',
                border: '#e8b4b8',
                indices: 'linear-gradient(to bottom, #e8b4b8, #f4d2d7, #d49499)',
                hands: 'linear-gradient(to top, #e8b4b8, #f4d2d7, #fff)',
                hourHands: 'linear-gradient(to top, #d49499, #e8b4b8, #f4d2d7, #fff)',
                minuteHands: 'linear-gradient(to top, #d49499, #e8b4b8, #f4d2d7, #fff)',
                centerHub: 'radial-gradient(circle at 30% 30%, #e8b4b8, #d49499, #b8787d), linear-gradient(45deg, #f4d2d7, #e8b4b8)',
                glow: 'rgba(232, 180, 184, 0.6)',
                digital: '#e8b4b8'
            },
            {
                name: 'ブラック',
                bezel: 'linear-gradient(45deg, #2a2a2a, #404040, #2a2a2a, #1a1a1a)',
                border: '#2a2a2a',
                indices: 'linear-gradient(to bottom, #2a2a2a, #404040, #1a1a1a)',
                hands: 'linear-gradient(to top, #2a2a2a, #404040, #666)',
                hourHands: 'linear-gradient(to top, #1a1a1a, #2a2a2a, #404040, #666)',
                minuteHands: 'linear-gradient(to top, #1a1a1a, #2a2a2a, #404040, #666)',
                centerHub: 'radial-gradient(circle at 30% 30%, #2a2a2a, #1a1a1a, #0a0a0a), linear-gradient(45deg, #404040, #2a2a2a)',
                glow: 'rgba(42, 42, 42, 0.6)',
                digital: '#2a2a2a'
            }
        ];
        
        // ===== デバイス傾き検出関数 =====
        function handleDeviceOrientation(event) {
            if (!isMobile) return;
            
            try {
                // デバイスの傾きを取得（gamma: 左右傾き, beta: 前後傾き）
                const gamma = event.gamma || 0; // -90 to 90 (左右)
                const beta = event.beta || 0;   // -180 to 180 (前後)
                
                // 傾きを制限して回転角度に変換
                const maxTilt = 30; // 最大傾き角度
                const rotateY = Math.max(-20, Math.min(20, (gamma / maxTilt) * 20));
                const rotateX = Math.max(-20, Math.min(20, -(beta / maxTilt) * 20));
                
                // 3D変形を適用
                watchCase.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.05)`;
                watchCase.style.boxShadow = `
                    0 0 100px rgba(255, 255, 255, 0.6),
                    inset 0 0 50px rgba(0, 0, 0, 0.08),
                    0 30px 80px rgba(0, 0, 0, 0.8),
                    0 10px 30px rgba(0, 0, 0, 0.4)
                `;
                
            } catch (error) {
                console.error('デバイス傾き処理中にエラーが発生しました:', error);
            }
        }
        
        // ===== モバイルデバイス傾き効果の初期化 =====
        function initializeDeviceOrientation() {
            if (!isMobile) return;
            
            // iOS 13+での許可要求
            if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
                DeviceOrientationEvent.requestPermission()
                    .then(permissionState => {
                        if (permissionState === 'granted') {
                            window.addEventListener('deviceorientation', handleDeviceOrientation);
                            deviceOrientationEnabled = true;
                            console.log('デバイス傾き検出が有効になりました');
                        }
                    })
                    .catch(console.error);
            } else {
                // その他のモバイルデバイス
                window.addEventListener('deviceorientation', handleDeviceOrientation);
                deviceOrientationEnabled = true;
                console.log('デバイス傾き検出が有効になりました');
            }
        }
        
        // マウスホバー開始時の処理
        watchCase.addEventListener('mouseenter', function() {
            if (isMobile) return; // モバイルではマウス効果を無効化
            
            console.log('マウスホバー開始');
            isHovering = true;
            
            this.style.transform = 'rotateX(15deg) rotateY(15deg) scale(1.05)';
            this.style.boxShadow = `
                0 0 100px rgba(255, 255, 255, 0.6),
                inset 0 0 50px rgba(0, 0, 0, 0.08),
                0 30px 80px rgba(0, 0, 0, 0.8),
                0 10px 30px rgba(0, 0, 0, 0.4)
            `;
        });
        
        // マウスホバー終了時の処理
        watchCase.addEventListener('mouseleave', function() {
            if (isMobile) return; // モバイルではマウス効果を無効化
            
            console.log('マウスホバー終了');
            isHovering = false;
            
            this.style.transform = 'rotateX(0deg) rotateY(0deg) scale(1)';
            this.style.boxShadow = `
                0 0 80px rgba(255, 255, 255, 0.4),
                inset 0 0 50px rgba(0, 0, 0, 0.08),
                0 25px 60px rgba(0, 0, 0, 0.6),
                0 5px 20px rgba(0, 0, 0, 0.3)
            `;
        });
        
        // ===== マウス移動による動的な光の反射効果 =====
        document.addEventListener('mousemove', function(e) {
            if (isMobile || !isHovering) return; // モバイルでは無効化
            
            try {
                const rect = watchCase.getBoundingClientRect();
                const centerX = rect.left + rect.width / 2;
                const centerY = rect.top + rect.height / 2;
                const mouseX = e.clientX - centerX;
                const mouseY = e.clientY - centerY;
                
                // マウス位置に基づいた回転角度の計算
                const rotateY = (mouseX / (rect.width / 2)) * 15;
                const rotateX = -(mouseY / (rect.height / 2)) * 15;
                
                watchCase.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.05)`;
                
            } catch (error) {
                console.error('マウス移動処理中にエラーが発生しました:', error);
            }
        });
        
        // ===== カラースキーム変更機能 =====
        function changeColorScheme() {
            currentColorScheme = (currentColorScheme + 1) % colorSchemes.length;
            const scheme = colorSchemes[currentColorScheme];
            
            // ベゼル色変更
            const diamondBezel = document.querySelector('.diamond-bezel');
            diamondBezel.style.background = `${scheme.bezel}, radial-gradient(circle at 30% 30%, #fff, transparent 60%)`;
            
            // インデックス色変更
            const hourIndices = document.querySelectorAll('.hour-index');
            hourIndices.forEach(index => {
                index.style.background = `${scheme.indices}, radial-gradient(ellipse at center, #fff, transparent 70%)`;
                index.style.boxShadow = `0 0 12px ${scheme.glow}, inset 0 0 3px rgba(255, 255, 255, 0.8)`;
            });
            
            // ダイヤモンド枠色変更
            const premiumDiamonds = document.querySelectorAll('.premium-diamond');
            premiumDiamonds.forEach(diamond => {
                diamond.style.borderColor = scheme.border;
                diamond.style.boxShadow = `0 0 25px rgba(255, 255, 255, 0.9), inset 0 0 8px rgba(0, 0, 0, 0.15), 0 0 15px ${scheme.glow}`;
            });
            
            // 針色変更
            const hourHand = document.getElementById('hourHand');
            const minuteHand = document.getElementById('minuteHand');
            hourHand.style.background = `${scheme.hourHands}, radial-gradient(ellipse at center, rgba(255, 255, 255, 0.9), transparent 60%)`;
            minuteHand.style.background = `${scheme.minuteHands}, radial-gradient(ellipse at center, rgba(255, 255, 255, 0.9), transparent 60%)`;
            
            // 中心ハブ色変更
            const centerHub = document.querySelector('.center-hub');
            centerHub.style.background = scheme.centerHub;
            centerHub.style.boxShadow = `0 0 15px ${scheme.glow}, inset 0 0 5px rgba(255, 255, 255, 0.6)`;
            
            // 日付表示枠色変更
            const dateDisplay = document.getElementById('dateWindow');
            dateDisplay.style.borderColor = scheme.border;
            dateDisplay.style.boxShadow = `inset 0 0 8px rgba(0, 0, 0, 0.15), 0 0 10px ${scheme.glow}`;
            
            // デジタル表示色変更
            const digitalClock = document.getElementById('digitalClock');
            digitalClock.style.color = scheme.digital;
            digitalClock.style.textShadow = `0 0 15px ${scheme.glow}, 0 0 30px ${scheme.glow.replace('0.6', '0.4')}`;
            digitalClock.style.borderColor = scheme.glow.replace('0.6', '0.3');
            
            // 歴史詳細表示の色も更新
            if (historyDetail.classList.contains('visible')) {
                updateHistoryDetailColors();
            }
            
            console.log(`カラースキームを${scheme.name}に変更しました`);
        }
        
        // 歴史表示のクリックイベント
        historyDisplay.addEventListener('click', function(e) {
            e.stopPropagation();
            console.log('歴史表示クリック:', {
                currentHistoryEvent: currentHistoryEvent,
                historyDisplayVisible: historyDisplay.classList.contains('visible')
            });
            if (currentHistoryEvent) {
                console.log('詳細表示を実行します');
                showHistoryDetail(currentHistoryEvent);
            } else {
                console.log('currentHistoryEventがnullです');
            }
        });
        
        // PCでのクリックイベント（歴史表示以外）
        if (!isMobile) {
            watchCase.addEventListener('click', function(e) {
                // 歴史表示がクリックされた場合は色変更しない
                if (e.target.closest('.history-display')) {
                    return;
                }
                e.preventDefault();
                changeColorScheme();
            });
        }
        
        // ===== 初期化処理 =====
        console.log('高級時計プログラムを初期化中...');
        
        // 歴史データを読み込んでから時計を開始
        loadHistoryData().then(() => {
            // 最初の時刻表示
            updateTimepiece();
            
            // 定期的な時刻更新（高頻度更新で滑らかな秒針）
            setInterval(updateTimepiece, CLOCK_UPDATE_INTERVAL);
            
            console.log('歴史時計機能が有効になりました');
        });
        
        // モバイルデバイス傾き効果の初期化
        if (isMobile) {
            // ユーザーの最初のタッチで傾き検出を有効化
            document.addEventListener('touchstart', function() {
                initializeDeviceOrientation();
            }, { once: true });
        }
        
        console.log('高級時計プログラムの初期化が完了しました');
    </script>
</body>
</html>